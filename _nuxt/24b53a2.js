(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{392:function(e,t,n){"use strict";n.r(t);n(14),n(54);var r={name:"Hello",props:["elements","parent"],computed:{lineId:{get:function(){return this.$store.getters.getLineId}},subLineId:{get:function(){return this.$store.getters.getSubLineId}}},methods:{style:function(e){var t="0,0,255";return"persName"===e||"rs"===e?t="0,255,0":"placeName"===e?t="255,0,0":"date"===e?t="255,165,0":"bibl"===e&&(t="128,0,128"),"background-color : rgba("+t+", 0.2);"},mouseover:function(e){this.highlight_line=e,this.$store.commit("setLineId",e)},selectSub:function(e){this.$store.commit("setSubLineId",e)},editBtnClick:function(e){this.$store.commit("setDialogFlag",!0),this.$store.commit("setDialogData",e)},anchorClick:function(e){this.$store.commit("setMainLineId",e)},childDiv:function(e){return e.elements[0].attributes?"div"===e.elements[0].attributes.rendition?"div":"span":null},getAnchorId:function(e){var t=e.attributes.corresp.split("#");return 2===t.length?t[1]:1===t.length?t[0]:null},selectManifest:function(e){this.$store.commit("setSelectedObj",e)}}},l=n(66),o=n(178),c=n.n(o),m=n(508),d=n(438),h=n(683),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[e._l(e.elements,(function(t,r){return[t.text?[n("span",{key:r},[e._v(e._s(t.text))])]:"p"===t.name||"head"===t.name||"ab"===t.name||"list"===t.name||"listPerson"===t.name||"item"===t.name||"person"===t.name?[n("span",{key:r,staticClass:"my-5",class:"tei-"+t.name},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:"date"===t.name?[n("v-tooltip",{key:r,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(l){var o=l.on;return[n("span",e._g({style:e.style(t.name)},o),[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.attributes))])])]:"teiHeader"===t.name?[n("v-sheet",{key:r,staticClass:"pa-5 ma-5",attrs:{color:"grey lighten-3"}},[n("small",[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)])]:"title"===t.name?[n("h2",{key:r,staticClass:"my-5"},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:"eaj:ruby"===t.name||t.attributes&&"ruby"===t.attributes.type?[n("ruby",{key:r},[n("Hello",{attrs:{elements:t.elements[0].elements}}),e._v(" "),n("rt",[e._v(e._s(t.elements[2].elements[0].text))])],1)]:"persName"===t.name||"placeName"===t.name||"name"===t.name||"rs"===t.name||"speaker"===t.name||"bibl"===t.name?[n("v-tooltip",{key:r,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(l){var o=l.on;return[n("span",e._g({key:r,class:"tei-"+t.name,style:"person"!=e.parent&&"respStmt"!=e.parent?e.style(t.name):"margin-right : 10px; margin-left : 10px;",attrs:{id:t.id}},t.attributes?o:null),[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.attributes))])])]:"seg"===t.name&&t.attributes&&t.attributes.rendition?[n("span",{key:r,class:"tei-"+t.attributes.rendition,style:t.attributes.style},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:"anchor"===t.name?[n("span",{key:r,staticStyle:{cursor:"pointer"},style:e.getAnchorId(t)===e.lineId?"background-color : rgba(255,165,0, 0.5);":"",attrs:{id:"anchor-"+e.getAnchorId(t),dark:""},on:{click:function(n){e.anchorClick(e.getAnchorId(t))},mouseover:function(n){e.mouseover(e.getAnchorId(t))}}},[n("v-icon",{attrs:{small:"",color:"blue darken-2"}},[e._v("mdi-anchor")])],1)]:"seg"===t.name&&t.attributes.corresp?[n("span",{key:r},[n("span",{class:"tei-"+t.name},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)])]:"s"===t.name?[n("div"===e.childDiv(t)?"div":"span",{key:r,tag:"component",style:t.attributes["xml:id"]===e.lineId?"background-color : rgba(255,165,0, 0.5);":"",on:{mouseover:function(n){return e.mouseover(t.attributes["xml:id"])},click:function(n){return e.selectSub(t.attributes["xml:id"])}}},[n("span",{class:"tei-"+t.name},[t.elements?n("Hello",{key:r,attrs:{id:"line-"+t.attributes["xml:id"],elements:t.elements,parent:t.name}}):e._e()],1)])]:"figure"!=t.name?[n("span",{key:r,class:"tei-"+t.name},[t.attributes&&t.attributes.facs&&t.attributes.facs.startsWith("#")?n("span",{staticStyle:{cursor:"pointer"},on:{click:function(n){return e.selectManifest(t)}}},[n("img",{staticClass:"ma-2",staticStyle:{width:"24px"},attrs:{src:"https://iiif.dl.itc.u-tokyo.ac.jp/images/iiif.png"}})]):e._e(),e._v(" "),t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:e._e()]}))],2)}),[],!1,null,null,null);t.default=component.exports;c()(component,{Hello:n(392).default}),c()(component,{VIcon:m.a,VSheet:d.a,VTooltip:h.a})},455:function(e,t){},456:function(e,t){},512:function(e,t,n){var content=n(675);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(76).default)("327ab9b0",content,!0,{sourceMap:!1})},674:function(e,t,n){"use strict";n(512)},675:function(e,t,n){var r=n(75)(!1);r.push([e.i,".scroll{height:100%;overflow-y:auto;word-wrap:break-word;word-break:break-all}.vertical{-ms-writing-mode:tb-rl;writing-mode:vertical-rl}#app,body,html{height:100%;margin:0}",""]),e.exports=r},694:function(e,t,n){"use strict";n.r(t);var r=n(9),l=(n(56),n(14),n(179),n(249),n(54),n(83),n(440)),o=(n(441),n(110)),c=n.n(o),m=n(392),d=n(516).scroller,h=n(670),v={components:{Splitpanes:l.b,Pane:l.a,Hello:m.default},data:function(){return{width:window.innerWidth,height:window.innerHeight,barHeight:0,returnUrl:null,returnLabel:null,dialogInformation:!1,dialogSettings:!1,urlMain:"",urlSub:"",dataMain:null,dataSub:null,imageMap:{},labelMain:"",labelSub:"",selectedManifests:[],miradorPath:"",direction:"vertical",layout:"2x2",paneSize:50}},computed:{mainLineId:{get:function(){return this.$store.getters.getMainLineId},set:function(e){this.$store.commit("setMainLineId",e)}},subLineId:{get:function(){return this.$store.getters.getSubLineId},set:function(e){this.$store.commit("setSubLineId",e)}},selectedObj:{get:function(){return this.$store.getters.getSelectedObj},set:function(e){this.$store.commit("setSelectedObj",e)}}},watch:{$route:function(){this.search()},mainLineId:function(){this.scroll("line-"+this.mainLineId,"sub")},subLineId:function(){this.scroll("anchor-"+this.subLineId,"main")},selectedObj:function(){for(var e=Number(this.selectedObj.attributes.n),t=this.selectedManifests,n=[],i=0;i<t.length;i++){var r=t[i];if(r.selected){var l=r.label,o=this.imageMap[l].data;if(o[e]){var c=o[e],m=c.split("#xywh="),canvas=m[0],d=m[1].split(","),h=Number(d[1])-150,v=Number(d[3])+150;c=canvas+"#xywh="+d[0]+","+h+","+d[2]+","+v,n.push({manifest:this.imageMap[l].manifest,canvas:c})}}}this.miradorPath="/mirador/?params="+encodeURIComponent(JSON.stringify(n))+"&annotationState=on&layout="+this.layout}},mounted:function(){var e=this,t=document.getElementById("bar");t&&(this.barHeight=t.clientHeight);var n=document.getElementById("main");n.addEventListener("wheel",(function(e){n.scrollLeft-=e.deltaY}));var r=document.getElementById("sub");r.addEventListener("wheel",(function(e){r.scrollLeft-=e.deltaY})),window.addEventListener("resize",this.handleResize),null===this.$route.query.u&&"localhost"!==location.hostname&&(location.href="https://github.com/TEI-EAJ/parallel_text_viewer/");var u=this.$route.query.u,l=this;c.a.get(u).then((function(t){var n=t.data;e.returnUrl=n.return_url||n.returnUrl,e.returnLabel=n.return_label||n.returnLabel,e.urlMain=n.urlMain||n.url_main,e.urlSub=n.urlSub||n.url_sub,e.labelMain=n.labelMain||n.label_main,e.labelSub=n.labelSub||n.labelsub,e.direction=n.direction,n.layout&&(e.layout=n.layout);var r=n.imageMap||n.image_map;c.a.get(r).then((function(t){var n=[],r={},o=t.data.selections,c=o.length;if(1===c)e.layout="1x1";else{var col=Math.ceil(c/2);e.layout="2x"+col}for(var i=0;i<o.length;i++){var m=o[i],d=m.members;if(0!==d.length){var h=m.within,v=h.label,f=h["@id"];r[v]={manifest:f,data:{}},n.push({manifest:f}),e.selectedManifests.push({label:v,selected:!0});for(var y=0;y<d.length;y++){var _=d[y],k=Number(_.label.split("p.")[1]);r[v].data[k]=_["@id"]}}}e.imageMap=r,e.miradorPath="/mirador/?params="+encodeURIComponent(JSON.stringify(n))+"&annotationState=on&layout="+e.layout,l.exec2main(e.urlMain),l.exec2sub(e.urlSub),setTimeout((function(){e.paneSize=49.9}),1e3)}))}))},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)},methods:{scroll:function(e,t){if(document.querySelector("#"+e)){var n=null,r=t;if("vertical"===this.direction){var l=document.querySelector("#"+r),o=document.querySelector("#"+e);n={container:"#"+r,offset:-1*l.getBoundingClientRect().width+(o?o.getBoundingClientRect().width:0),x:!0}}else n={container:"#"+r,y:!0};d()("#"+e,500,n)}},handleResize:function(){this.width=window.innerWidth,this.height=window.innerHeight},exec2main:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.a.get(e).then((function(e){var n=e.data;"string"==typeof n&&(n=(new DOMParser).parseFromString(n,"text/xml"));var r=(new XMLSerializer).serializeToString(n),l=h.xml2json(r,{compact:!1,spaces:4});t.dataMain=JSON.parse(l)}));case 2:case"end":return n.stop()}}),n)})))()},exec2sub:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.a.get(e).then((function(e){var n=e.data;"string"==typeof n&&(n=(new DOMParser).parseFromString(n,"text/xml"));var r=(new XMLSerializer).serializeToString(n),l=h.xml2json(r,{compact:!1,spaces:4});t.dataSub=JSON.parse(l)}));case 2:case"end":return n.stop()}}),n)})))()},changeLocale:function(){this.$emit("change-locale")}}},f=(n(674),n(66)),y=n(178),_=n.n(y),k=n(362),w=n(696),S=n(506),x=n(373),I=n(690),M=n(508),L=n(697),$=n(685),C=n(695),H=n(693),V=n(513),z=n(384),component=Object(f.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",[n("v-toolbar",{attrs:{id:"bar",dark:!0,flat:""}},[n("v-toolbar-title",[e._v("Parallel Text Viewer with TEI & IIIF")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.dialogSettings=!0}}},[n("v-icon",[e._v("mdi-settings")])],1),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.dialogInformation=!0}}},[n("v-icon",[e._v("mdi-information")])],1),e._v(" "),n("v-toolbar-items",{directives:[{name:"show",rawName:"v-show",value:e.returnUrl,expression:"returnUrl"}]},[n("v-btn",{attrs:{text:"",href:e.returnUrl}},[e._v(e._s(e.returnLabel))])],1),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:e.changeLocale}},[e._v("\n        "+e._s(e.$t("change_locale"))+"\n      ")])],1),e._v(" "),n("div",{style:"height: "+(e.height-e.barHeight)+"px"},[n("splitpanes",{staticClass:"default-theme"},[n("pane",{attrs:{size:e.paneSize}},[n("iframe",{staticStyle:{border:"none"},attrs:{src:e.miradorPath,seamless:"seamless",width:"100%",height:e.height-e.barHeight+"px",allow:"fullscreen"}})]),e._v(" "),n("pane",{attrs:{size:100-e.paneSize}},[n("splitpanes",{staticClass:"default-theme",attrs:{horizontal:"horizontal"}},[n("pane",[n("v-card",{staticClass:"scroll vertical",attrs:{id:"main",flat:!0}},[e.dataMain?n("Hello",{attrs:{elements:e.dataMain.elements}}):e._e()],1)],1),e._v(" "),n("pane",[n("v-card",{staticClass:"scroll vertical",attrs:{id:"sub",flat:!0}},[e.dataSub?n("Hello",{attrs:{elements:e.dataSub.elements}}):e._e()],1)],1)],1)],1)],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{width:"600px"},model:{value:e.dialogInformation,callback:function(t){e.dialogInformation=t},expression:"dialogInformation"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v(e._s(e.$t("information")))]),e._v(" "),n("v-card-text",{staticClass:"mt-5"},[n("a",{attrs:{target:"_blank",href:e.$route.query.u}},[e._v(e._s(e.$route.query.u))])]),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"secondary"},on:{click:function(t){e.dialogInformation=!1}}},[e._v(e._s(e.$t("close")))])],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{width:"600px"},model:{value:e.dialogSettings,callback:function(t){e.dialogSettings=t},expression:"dialogSettings"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v(e._s(e.$t("settings")))]),e._v(" "),n("v-card-text",{staticClass:"mt-5"},[n("v-text-field",{staticClass:"mb-5",attrs:{label:"Mirador表示レイアウト Ex. 1x1, 2x2, ..."},model:{value:e.layout,callback:function(t){e.layout=t},expression:"layout"}}),e._v(" "),e._l(e.selectedManifests,(function(t,r){return n("v-switch",{key:r,attrs:{label:t.label},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"obj.selected"}})}))],2),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"secondary"},on:{click:function(t){e.dialogSettings=!1}}},[e._v(e._s(e.$t("close")))])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;_()(component,{Hello:n(392).default}),_()(component,{VApp:k.a,VBtn:w.a,VCard:S.a,VCardActions:x.a,VCardText:x.b,VCardTitle:x.c,VDialog:I.a,VIcon:M.a,VMain:L.a,VSpacer:$.a,VSwitch:C.a,VTextField:H.a,VToolbar:V.a,VToolbarItems:z.a,VToolbarTitle:z.b})}}]);